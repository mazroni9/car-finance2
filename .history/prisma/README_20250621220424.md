# توثيق Prisma في مشروع تمويل السيارات

## الملفات المرتبطة مع Prisma

### ملفات التكوين
1. `prisma/schema.prisma`
   - يحتوي على تعريف نماذج البيانات
   - يحدد إعدادات قاعدة البيانات
   - يضبط مولد العميل

2. `prisma/seed.ts`
   - ملف تهيئة البيانات الأولية
   - يستخدم لإضافة البيانات الافتراضية

### ملف الاتصال
- `src/lib/db.ts`
  - تهيئة Prisma Client
  - نقطة الاتصال المركزية مع قاعدة البيانات

### ملفات تستخدم Prisma
1. صفحات الواجهة:
   - `src/app/cars/page.tsx`: عرض السيارات
   - `src/app/cars/[id]/page.tsx`: تفاصيل السيارة

2. واجهات برمجة التطبيق (API):
   - `src/app/api/cars/route.ts`: إدارة السيارات
   - `src/app/api/financial-summary/route.ts`: الملخص المالي

## النماذج الحالية (Models)

### 1. نموذج السيارات (Car)
```prisma
model Car {
  id                Int
  priceCategory     Int      // الفئة السعرية
  quantity         Int      // عدد السيارات
  downPaymentRate  Float    // نسبة الدفعة الأولى
  downPayment      Int      // الدفعة الأولى
  lastPayment      Int      // دفعة آخيرة
  monthlyIncome    Int      // الدخل الشهري
  // ... المزيد من الحقول
}
```

### 2. نموذج خطط التقسيط (InstallmentPlan)
```prisma
model InstallmentPlan {
  id              Int
  months          Int      // مدة التقسيط
  profitRate      Float    // نسبة الربح
  monthlyPayment  Int      // القسط الشهري
  cars            Car[]    // العلاقة مع السيارات
}
```

### 3. نموذج الملخص المالي (FinancialSummary)
```prisma
model FinancialSummary {
  id                  Int
  totalAnnualCost     Int    // تكلفة الدخل السنوية
  totalAnnualIncome   Int    // الدخل السنوي
  // ... المزيد من الحقول
}
```

## التحديثات المطلوبة

### 1. تحديث نموذج خطط التقسيط
- تحديث النموذج ليناسب متطلبات حاسبة التمويل
- إضافة حقول جديدة لدعم المزيد من الخيارات

### 2. إضافة نموذج عمليات التمويل
- إنشاء نموذج جديد لتخزين عمليات التمويل
- ربطه مع نماذج السيارات وخطط التقسيط

### 3. تحديث API التمويل
- تعديل `src/app/api/finance/calculate/route.ts`
- ربط الحسابات مع قاعدة البيانات
- تخزين نتائج العمليات

### 4. تحديث واجهة المستخدم
- تحديث صفحة حاسبة التمويل
- عرض البيانات من قاعدة البيانات
- إضافة ميزات جديدة

## ملاحظات مهمة
- يجب تشغيل `npx prisma generate` بعد أي تغيير في ملف `schema.prisma`
- يجب تشغيل `npx prisma migrate dev` لتطبيق التغييرات على قاعدة البيانات
- يجب تشغيل `npx prisma db seed` لتهيئة البيانات الأولية 