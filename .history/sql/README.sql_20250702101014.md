# دليل ملفات SQL – مشروع car-finance

هذا المجلد يحتوي على ملفات إعداد قاعدة البيانات الخاصة بمنصة `car-finance`.

---

## 📁 محتويات المجلد

| الملف                          | الوصف                                                                 |
|-------------------------------|------------------------------------------------------------------------|
| `car_finance_schema.sql`      | يحتوي على الجداول الأساسية: العملاء، السيارات، التمويل، المستثمرين، الاشتراكات، العمليات المالية |
| `installment_rules_schema.sql`| يحتوي على جداول خاصة بمنطق التقسيط: قواعد التسعير، View لحساب الأقساط، ودالة `calculate_installment_offer` |

---

## 🛠️ خطوات التنفيذ

1. قم بإنشاء قاعدة بيانات جديدة باسم `car_finance`
2. نفذ الملف `car_finance_schema.sql` أولاً لإنشاء الجداول الأساسية
3. نفذ الملف `installment_rules_schema.sql` لإضافة منطق التقسيط والحسابات

---

## ✅ ملاحظات مهمة

- يجب تنفيذ الملفات بالترتيب المذكور أعلاه
- الملف `car_finance_schema.sql` يحتوي على بيانات تجريبية، يمكنك تعديل أو حذف أوامر INSERT إذا كنت لا تريد هذه البيانات
- يمكنك تعديل قواعد التقسيط في `installment_rules_schema.sql` حسب احتياجات العمل
- استخدم الدالة `calculate_installment_offer(...)` لحساب عروض التقسيط

---

## 🔄 تحديث القواعد

لتحديث قواعد التقسيط:
1. افتح ملف `installment_rules_schema.sql`
2. عدل قيم `pricing_rules` حسب الحاجة
3. يمكنك إضافة فئات سعرية جديدة أو تعديل النسب الحالية
4. أعد تشغيل الأوامر الخاصة بـ `pricing_rules` فقط

---

## 📊 الدوال المتاحة

- `calculate_installment_offer(car_price, down_payment_percent, final_payment_percent, term_months, profit_rate)`
  - تحسب تفاصيل عرض التقسيط بناءً على المدخلات
  - تعيد جدولاً يحتوي على جميع التفاصيل المالية

- `installment_offer_view`
  - عرض يوفر مثالاً حياً لحساب التقسيط
  - مفيد للاختبار والتحقق من صحة الحسابات

تم إنشاؤه تلقائيًا بواسطة OpenAI Assistant.